---
title: "R Notebook"
output: html_notebook
---

```{r}
library(lubridate)
library(ggplot2)
library(tidyverse)

rice <- read.csv('rice_remote_sensing - Sheet1.csv', header=T)
rice$Date <- as.Date(rice$Date, "%m-%d-%Y")
rice <- subset(rice, Date != "2019-06-13")
#rice.long <- rice %>% pivot_longer(c(Train_MSE, Val_MSE))
rice.long <- rice %>% pivot_longer(c(Train_MSE, Val_MSE, Test_MSE))

ggplot(rice.long, aes(x=Date, y=sqrt(value), col=name)) + geom_line(size=0.25) + facet_grid(Set~Model) + theme_bw() + geom_hline(yintercept = sqrt(17.3)^2, col="red", lty=2) + scale_color_manual(values = c("black","grey70", "grey50"), name="Dataset", labels=c("Test", "Train", "Validation")) + scale_linetype(name="Fold") + ylab("RMSE") + theme(axis.text.x = element_text(angle = 90, vjust=0.4))#+ geom_point(size=0.3)

#ggplot(rice.long, aes(x=Date, y=sqrt(value), col=name)) + geom_line(size=0.4) + facet_grid(Set~Model) + theme_minimal() + geom_hline(yintercept = sqrt(17.3)^2, col="red", lty=2) + scale_color_manual(values = c("grey70", "black"), name="Dataset", labels=c("Train", "Validation")) + scale_linetype(name="Fold") + ylab("RMSE") + theme(axis.text.x = element_text(angle = 90, vjust=0.4))#+ geom_point(size=0.2)
```
```{r}
rice.test <- rice.long %>% group_by(Model, Date, name) %>% 
  summarize(meanMSE = mean(value), sdMSE = sd(value)) %>%
  filter(name == "Test_MSE")

rice.test2 <- subset(rice.test, Model == "2DCNN")

ggplot(rice.test2, aes(x=Date, y=meanMSE, col= Model)) + 
  geom_line(size=1) + 
  theme_minimal() + 
  scale_color_manual(values = c("black")) + 
  ylab("Test Set MSE (mean)")  + 
  geom_hline(yintercept = (17.3)^2, lty=2, col = "red")+
  geom_point() +
  geom_errorbar(aes(ymin=meanMSE-sdMSE, ymax=meanMSE+sdMSE), width=.2)
```


